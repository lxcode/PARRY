BEGIN   % THIS FILE IS FOR MAKING A DIALOG WITH DIA AND DIA2[PAR,BLF]  %

SPECIAL
	CHANSAVE, INCHAN, SAVE_FILE, EOF, FILE1, FILE2, DIACHARNO,
	INPUTFILE, PMINPUT, PM2INPUT, BUG;


DEFINE CAR , CDR , PROG2  3 3, SET0   5 5, CONS  86 83, 
	THEN , ELSE \, CARN PREFIX, CHOOSE PREFIX, BL PREFIX, NUMED PREFIX;


EXPR SELECTINPUTN(AREA,FILE);

	IF GET('INCHAN,'INCHAN) THEN  PUTPROP('INCHAN,T,'INCHAN)
	ALSO IF FILE THEN INCHAN  EVAL( < 'INPUT, INPUTFILEAREA, FILE > ) ;

EXPR SELECTINPUTNN(AREA, FILE);

	   IF FILE THEN  INCHANEVAL(<'INPUT,INPUTFILEAREA,FILE>)
		   ALSO INC(NIL,NIL);

EXPR DISKREAD2(NAME);

	BEGIN NEW A,B,CHARNO;
	IF GET(NAME,'INCORE) THEN RETURN T;
	IF GET('DSKLOC,'SUBR) THEN ADSKLOC(NAME);  % GET THE CHAR NO OF THE SEXPR %
	IF A THEN RETURN NIL;  % NOT THERE %
	CHARNOA;
	 % CHARNO IS THE CHARACTER NUMBER IN THE FILE THAT THE SEXPR NAME BEGINS ON %
	 % IF A RECNO IS NEEDED, IT IS CHARNO/OCTAL 1200 + 1 (FIRST RECORD IS REC 1 %

	CHANSAVEINC(NIL,NIL);
	INIT();		% INITIALIZE THE READ CHANNEL FOR THE MEMORY FILE %
	INC(INCHAN,NIL);
	CHSETI(INCHAN,CHARNO);  % SET THE INPUT POINTER TO THE CORRECT SEXPR %
	BREAD();
	INC(CHANSAVE,NIL);

	IF B THEN PUTPROP(NAME,T,'INCORE);
	IF B='?#B THEN BEL( B) ELSE IF B='?#E THEN ENG( B);  % LINK UP IN MEMORY %
	RETURN B;
	END;

EXPR CARN(L);  IF ATOM L THEN L ELSE L;  % RETURNS CAR OF A LIST %




EXPR REACTPRINT(L);	% FORMATS AND PRINTS THE OUTPUT TO TTY AND DIA FILE %
	BEGIN	NEW SENT, ISENT, N;
	SENT  L;
	%       SUPPRESS NON-VERBALS HERE	%
	BUG43;
	IF SUPPRESS  SENT  ATOM SENT THEN SENTSENT;
%	SENT  IF SENT THEN STRINGATE (SENT) ELSE " "; %
	TERPRI NIL;
%	PRINTSTR  SENT; %
	ISENT  INPUTSSENT;
	BUG44;
	ISENT %STRINGATE% (IF ISENT  ISENT THEN REVERSE(ISENT) ELSE ISENT);
	N <TRACE_MEM, NEWPROVEN, INTENT>;
	BUG45;

	IF SAVE_FILE THEN  TO_FILE(ISENT, SENT, N ) ;
	BUG46;
	INPUTSSENTNIL;
	END;

END.

