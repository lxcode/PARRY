BEGIN   % THIS FILE HAS FUNCTIONS FOR THE WINDOW FEATURE      %

SPECIAL WINDOWS;
NEW     WINDOWS;

DEFINE CAR PREFIX , CDR PREFIX , PROG2  3 3, SET0   5 5, CONS  86 83,
	THEN , ELSE \, STOREBYTE  5 5, CARN PREFIX, CHOOSE PREFIX, BL PREFIX;

EXPR PMCLR();
	BEGIN WINSUP(T);
	FOR NEW I1 TO 29 DO IF (I=9) THEN WINREL(I);
	WINDIS(); WINSUP(NIL);
	END;

EXPR MMCLR();
	BEGIN WINSUP(T);
	FOR NEW I30 TO 64 DO WINREL(I);
	WINDIS(); WINSUP(NIL);
	END;

EXPR WINDOW(N,FLAG,L);

	BEGIN NEW M;  
	IF TRACEV='ALL THEN TWINDOW(N,FLAG,L) ALSO RETURN L;
	IF WINDOWS THEN RETURN L;
	MIF STRP L THEN L ELSE STR L;
	IF SPECWIN(N) THEN INTEST();
	WINOUT(N,FLAG,M);
	IF (N=9)  (N=49) THEN WINSUP(NIL) ALSO WINDIS();
	RETURN L;
	END;

EXPR SPECWIN(N); (N=1) OR (N=31);

EXPR WININIT();
	BEGIN   WINDOWST;
	WINHELP(); WINDOW(2,T,NIL);
	WINXIT(); WINSIL(30); WINSIZ(4,2);  WINDIS();
	TRACEVNIL;
	END;

EXPR WINHELP(); 
 	PRINTSTR(
"NEW EASIER WINDOW COMMANDS:
    ESC I   IS A BINARY SWITCH TO HALT AND CONTINUE PROCESSING 
   YOU ARE NOW HALTED. TYPE  ESC I  TO CONTINUE.  " );

EXPR WINDOWSET(N);

	BEGIN  IF WINDOWS THEN RETURN NIL;
	IF N = 1  THEN MMCLR()
		ALSO PMWIN();
	IF N = 2  THEN SLEEP(1) ALSO PMCLR()
		ALSO MMWIN2()
		ALSO WINDOW(32,T,PMINPUT) ALSO WINDOW(32,NIL,GET(PMINPUT,'BONDVALUE))
		ALSO WINDIS() ALSO WINREL(9) ALSO WINDIS()
		ALSO MMWIN();
	END;

EXPR TWINDOW(N,FLAG,L);  % PRINTS OUT WINDOW STUFF FOR A TELETYPE %
	BEGIN NEW A;
	AASSOC ( N, '(	( 2 . "Input:	" )
			( 3 . "Respelled:  " )
			( 4 . "Canonical form:  " )
			( 5 . "Segmented:  " )
			( 7 . "Simple patterns:  " )
			( 9 . "Result:  " )
			( 33 . "Preprocess:  " )
			( 36 . "Inferences succeeded:  " )
			( 37 . "New beliefs:  " )
			( 40 . "Emotions:  " )
			( 42 . "Intentions:  " )
			( 44 . "Action:  " )		) );
	IF A  (FLAG  (N=36)  (N=42)) THEN PRINC CDR A  ALSO PRINTSTR L;
	END;
	% INITIALIZING WINDOWS %

EXPR PMWIN();
	BEGIN NEW SENTL;
	WINSUP(T);
	SENTL76; TEN();
	WINSIL(30);
	WINSIZ(4, 2);

	WINOPN(1, 9, 0, 16, 3);
	WINLBL(1, 'PROCESS);
	WINOPN(2, 0, 3, SENTL, 3);
	WINLBL(2, "INPUT SENTENCE");
	WINDIS(T);

	WINOPN(11, 12, 6, 16, 3);
	WINLBL(11, "WORD");
	WINOPN(12, 42, 6, 22, 3);
	WINLBL(12, "RESPELLED");
	WINOPN(3, 0, 9, SENTL, 3);
	WINLBL(3, "RESPELLED INPUT");
	WINOPN(13,  6, 12, 16, 3);
	WINLBL(13, "WORD");
	WINOPN(14, 27, 12, 22, 3);
	WINLBL(14, "IDIOMS FOUND");
	WINOPN(15, 54, 12, 16, 3);
	WINLBL(15, "ANAPHS FOUND");

	WINOPN(4, 0, 15, SENTL, 3);
	WINLBL(4, "CANONIZED INPUT");
	WINOPN(5, 0, 18, SENTL, 3);
	WINLBL(5, "SEGMENTED INPUT");

	WINOPN(16, 5, 21, 33, 3);
	WINLBL(16, "SIMPLE PATTERN");
	WINOPN(17, 42, 21, 33, 3);
	WINLBL(17, "PATTERNS TRIED");
	WINOPN(7, 3, 24, 60, 3);
	WINLBL(7, "MATCHED SIMPLE PATTERNS");
	WINOPN(8, 0, 27, 30, 3);
	WINLBL(8, "COMPOUND PATTERN");
	WINDIS();

	WINOPN(9, 37, 27, 38, 3);
	WINLBL(9, "INPUT RECOGNIZED");
	WINDIS();

	WINSUP(NIL);
	END;

EXPR MMWIN();
	BEGIN NEW SENTL,HSENTL;
	WINSUP(T);
	SENTL76; HSENTL36;  TEN();

	WINOPN(51, 41, 3, 19, 3);
	WINLBL(51, "TOPIC");
	WINOPN(52, 62, 3, 14, 3);
	WINLBL(52, "ANAPHORA");

	WINOPN(33, 4, 6, SENTL-8, 3);
	WINLBL(33, "PREPROCESS RESULTS");

	WINOPN(35, 0, 9, HSENTL, 6);
	WINLBL(35, "INFERENCES TRIED");
	WINOPN(36, 38, 9, HSENTL, 6);
	WINLBL(36, "INFERENCES SUCCEEDED");
	WINOPN(37, 0, 15, HSENTL+17, 4);
	WINLBL(37, "NEW BELIEFS");

	WINOPN(40,  5, 19, 43, 5);
	WINLBL(40, "AFFECT CHANGES");
	WINOPN(41, 55, 17, 22, 6);
	WINLBL(41, "CURRENT AFFECTS");
	WINOPN(42, 0, 24, HSENTL+17, 3);
	WINLBL(42, "INTENTIONS");

	WINOPN(44, 58, 24, 16, 3);
	WINLBL(44, "ACTIONS");

	WINDIS();

	WINOPN(49, 0, 27, SENTL, 3);
	WINLBL(49, "OUTPUT SENTENCES");

	WINDIS();
	WINSUP(NIL);
	END;

EXPR MMWIN2();
	BEGIN  WINSUP(T);
	WINOPN(31, 9, 0, 16, 3);
	WINLBL(31, 'PROCESS);
	WINOPN(32, 0, 3, 38, 3);
	WINLBL(32, "INPUT STRUCTURE");
	END;

END.
_EOF_ 
